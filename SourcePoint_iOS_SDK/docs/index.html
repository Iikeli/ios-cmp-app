<!DOCTYPE html>
<html lang="en">
  <head>
    <title>  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html"> Docs</a> (100% documented)</p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html"> Reference</a>
        <img id="carat" src="img/carat.png" />
          Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/ConsentWebView.html">ConsentWebView</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='ios-setup-guide' class='heading'>iOS Setup guide</h1>

<ul>
<li><p>Clone <a href="https://github.com/SourcePointUSA/ios-cmp-app">https://github.com/SourcePointUSA/ios-cmp-app</a> repository to an arbitrary directory on your system.
Open your existing iOS app in xcode
Make sure you do NOT have the SourcePoint_iOS_SDK project open in xcode and drag SourcePoint_iOS_SDK/SourcePoint_iOS_SDK.xcodeproj file to xcode’s navigation panel on the left, directly under the root item of your project. <img width="664" alt="screen shot 2018-11-01 at 10 06 25 am" src="https://user-images.githubusercontent.com/2576311/47862463-930cf680-ddcb-11e8-8668-9016db8edb49.png"></p></li>
<li><p>Change the active scheme to SourcePoint_iOS_SDK on the top bar and build the library from Product -&gt; Build (cmd + B). <img width="854" alt="screen shot 2018-11-01 at 11 33 04 am" src="https://user-images.githubusercontent.com/2576311/47862464-930cf680-ddcb-11e8-9477-9b956c8f9ff2.png"></p></li>
<li><p>Select the project (root item) on the left navigation panel in xcode and select the target you want to add the CMP library to under the TARGETS list. Expand SourcePoint_iOS_SDK.xcodeproj/SourcePoint_iOS_SDK/Products in the navigation panel and drag Consent_String_SDK_Swift.framewrok to the list of “Embedded Binaries” <img width="1130" alt="screen shot 2018-11-01 at 11 35 06 am" src="https://user-images.githubusercontent.com/2576311/47862465-930cf680-ddcb-11e8-9b05-947c0de39451.png"></p></li>
<li><p>Import SourcePoint_iOS_SDK module in your AppDelegate.swift to test the library can be imported successfully
Switch back the active schema to your own project and run the app and you should be all set</p></li>
</ul>
<h1 id='how-to-use-the-consentwebview-widget' class='heading'>How to use the ConsentWebView widget</h1>

<ul>
<li><p>Open your project’s info.plist file and make sure you have App Transport Security Settings/Allow Arbitrary Loads set to YES <img width="856" alt="screen shot 2018-11-01 at 11 36 50 am" src="https://user-images.githubusercontent.com/2576311/47862466-93a58d00-ddcb-11e8-99e8-2acaac6aef2b.png"></p></li>
<li><p>Instantiate a ConsentWebView object in your main ViewController, set configuration variables and a onInteractionComplete callback and add the ConsentWebView to your ViewController as a subview:</p></li>
</ul>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">UIKit</span>
<span class="kd">import</span> <span class="kt">SourcePoint_iOS_SDK</span>


<span class="kd">class</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">consentWebView</span><span class="p">:</span> <span class="kt">ConsentWebView</span><span class="o">!</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        <span class="n">consentWebView</span> <span class="o">=</span> <span class="kt">ConsentWebView</span><span class="p">(</span>
            <span class="c1">// required, must be set first used to find account</span>
            <span class="nv">accountId</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span>
            <span class="c1">// required, must be set second used to find scenario</span>
            <span class="nv">siteName</span><span class="p">:</span> <span class="s">"app.ios.cmp"</span>
        <span class="p">)</span>

        <span class="c1">// optional, used for logging purposes for which page of the app the consent lib was</span>
        <span class="c1">// rendered on</span>
        <span class="n">consentWebView</span><span class="o">.</span><span class="n">page</span> <span class="o">=</span> <span class="s">"main"</span>

        <span class="c1">// optional, used for running stage campaigns</span>
        <span class="n">consentWebView</span><span class="o">.</span><span class="n">isStage</span> <span class="o">=</span> <span class="kc">false</span>

        <span class="c1">// optional, used for running against our stage endpoints</span>
        <span class="n">consentWebView</span><span class="o">.</span><span class="n">isInternalStage</span> <span class="o">=</span> <span class="kc">true</span>

        <span class="c1">// optional, should not ever be needed provide a custom url for the messaging page</span>
        <span class="c1">// (overrides internal stage)</span>
        <span class="n">consentWebView</span><span class="o">.</span><span class="n">inAppMessagingPageUrl</span> <span class="o">=</span> <span class="kc">nil</span>

        <span class="c1">// optional, should not ever be needed provide a custom domain for mms (overrides</span>
        <span class="c1">// internal stage)</span>
        <span class="n">consentWebView</span><span class="o">.</span><span class="n">mmsDomain</span> <span class="o">=</span> <span class="kc">nil</span>

        <span class="c1">// optional, should not ever be needed provide a custom domain for cmp (overrides</span>
        <span class="c1">// internal stage)</span>
        <span class="n">consentWebView</span><span class="o">.</span><span class="n">cmpDomain</span> <span class="o">=</span> <span class="kc">nil</span>

        <span class="c1">// optional, sets debug level defaults to OFF</span>
        <span class="n">consentWebView</span><span class="o">.</span><span class="n">debugLevel</span> <span class="o">=</span> <span class="kt">ConsentWebView</span><span class="o">.</span><span class="kt">DebugLevel</span><span class="o">.</span><span class="kt">OFF</span>

        <span class="c1">// optional, callback triggered when message data is loaded when called message data</span>
        <span class="c1">// will be available as String at cbw.msgJSON</span>
        <span class="n">consentWebView</span><span class="o">.</span><span class="n">onReceiveMessageData</span> <span class="o">=</span> <span class="p">{</span> <span class="p">(</span><span class="nv">cbw</span><span class="p">:</span> <span class="kt">ConsentWebView</span><span class="p">)</span> <span class="k">in</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"msgJSON from backend"</span><span class="p">,</span> <span class="n">cbw</span><span class="o">.</span><span class="n">msgJSON</span> <span class="k">as</span> <span class="kt">Any</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1">// optional, callback triggered when message choice is selected when called choice</span>
        <span class="c1">// type will be available as Integer at cbw.choiceType</span>
        <span class="n">consentWebView</span><span class="o">.</span><span class="n">onMessageChoiceSelect</span> <span class="o">=</span> <span class="p">{</span> <span class="n">cbw</span> <span class="k">in</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Choice type selected by user"</span><span class="p">,</span> <span class="n">cbw</span><span class="o">.</span><span class="n">choiceType</span> <span class="k">as</span> <span class="kt">Any</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1">// optional, callback triggered when consent data is captured when called</span>
        <span class="c1">// euconsent will be available as String at cLib.euconsent and under</span>
        <span class="c1">// PreferenceManager.getDefaultSharedPreferences(activity).getString(EU_CONSENT_KEY, null);</span>
        <span class="c1">// consentUUID will be available as String at cLib.consentUUID and under</span>
        <span class="c1">// PreferenceManager.getDefaultSharedPreferences(activity).getString(CONSENT_UUID_KEY null);</span>
        <span class="n">consentWebView</span><span class="o">.</span><span class="n">onInteractionComplete</span> <span class="o">=</span> <span class="p">{</span> <span class="p">(</span><span class="nv">cbw</span><span class="p">:</span> <span class="kt">ConsentWebView</span><span class="p">)</span> <span class="k">in</span>
            <span class="nf">print</span><span class="p">(</span>
                <span class="s">"</span><span class="se">\n</span><span class="s">eu consent prop"</span><span class="p">,</span>
                <span class="n">cbw</span><span class="o">.</span><span class="n">euconsent</span> <span class="k">as</span> <span class="kt">Any</span><span class="p">,</span>
                <span class="s">"</span><span class="se">\n</span><span class="s">consent uuid prop"</span><span class="p">,</span>
                <span class="n">cbw</span><span class="o">.</span><span class="n">consentUUID</span> <span class="k">as</span> <span class="kt">Any</span><span class="p">,</span>
                <span class="s">"</span><span class="se">\n</span><span class="s">eu consent in storage"</span><span class="p">,</span>
                <span class="kt">UserDefaults</span><span class="o">.</span><span class="n">standard</span><span class="o">.</span><span class="nf">string</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="kt">ConsentWebView</span><span class="o">.</span><span class="kt">EU_CONSENT_KEY</span><span class="p">)</span> <span class="k">as</span> <span class="kt">Any</span><span class="p">,</span>
                <span class="s">"</span><span class="se">\n</span><span class="s">consent uuid in storage"</span><span class="p">,</span>
                <span class="kt">UserDefaults</span><span class="o">.</span><span class="n">standard</span><span class="o">.</span><span class="nf">string</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="kt">ConsentWebView</span><span class="o">.</span><span class="kt">CONSENT_UUID_KEY</span><span class="p">)</span> <span class="k">as</span> <span class="kt">Any</span><span class="p">,</span>
                <span class="s">"</span><span class="se">\n</span><span class="s">custom vendor consent"</span><span class="p">,</span>
                <span class="n">cbw</span><span class="o">.</span><span class="nf">getVendorConsents</span><span class="p">([</span><span class="s">"5bc76807196d3c5730cbab05"</span><span class="p">,</span> <span class="s">"5bc768d8196d3c5730cbab06"</span><span class="p">]),</span>
                <span class="s">"</span><span class="se">\n</span><span class="s">IABConsent_ConsentString in storage"</span><span class="p">,</span>
                <span class="kt">UserDefaults</span><span class="o">.</span><span class="n">standard</span><span class="o">.</span><span class="nf">string</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="kt">ConsentWebView</span><span class="o">.</span><span class="kt">IAB_CONSENT_CONSENT_STRING</span><span class="p">)</span> <span class="k">as</span> <span class="kt">Any</span><span class="p">,</span>
                <span class="s">"</span><span class="se">\n</span><span class="s">IABConsent_ParsedPurposeConsents in storage"</span><span class="p">,</span>
                <span class="kt">UserDefaults</span><span class="o">.</span><span class="n">standard</span><span class="o">.</span><span class="nf">string</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="kt">ConsentWebView</span><span class="o">.</span><span class="kt">IAB_CONSENT_PARSED_PURPOSE_CONSENTS</span><span class="p">)</span> <span class="k">as</span> <span class="kt">Any</span><span class="p">,</span>
                <span class="s">"</span><span class="se">\n</span><span class="s">IABConsent_ParsedVendorConsents in storage"</span><span class="p">,</span>
                <span class="kt">UserDefaults</span><span class="o">.</span><span class="n">standard</span><span class="o">.</span><span class="nf">string</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="kt">ConsentWebView</span><span class="o">.</span><span class="kt">IAB_CONSENT_PARSED_VENDOR_CONSENTS</span><span class="p">)</span> <span class="k">as</span> <span class="kt">Any</span>
            <span class="p">)</span>
        <span class="p">}</span>

        <span class="n">view</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="n">gray</span>

        <span class="n">view</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">consentWebView</span><span class="o">.</span><span class="n">view</span><span class="p">)</span>

        <span class="c1">// IABConsent_CMPPresent is set immediately after loading the ConsentWebView</span>
        <span class="nf">print</span><span class="p">(</span>
            <span class="s">"IABConsent_CMPPresent in storage"</span><span class="p">,</span>
            <span class="kt">UserDefaults</span><span class="o">.</span><span class="n">standard</span><span class="o">.</span><span class="nf">string</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="kt">ConsentWebView</span><span class="o">.</span><span class="kt">IAB_CONSENT_CMP_PRESENT</span><span class="p">)</span> <span class="k">as</span> <span class="kt">Any</span><span class="p">,</span>
            <span class="s">"IABConsent_SubjectToGDPR in storage"</span><span class="p">,</span>
            <span class="kt">UserDefaults</span><span class="o">.</span><span class="n">standard</span><span class="o">.</span><span class="nf">string</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="kt">ConsentWebView</span><span class="o">.</span><span class="kt">IAB_CONSENT_SUBJECT_TO_GDPR</span><span class="p">)</span> <span class="k">as</span> <span class="kt">Any</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre>
<h1 id='how-to-build-the-and-export-the-framework-as-a-binary-untested' class='heading'>How to build the and export the framework as a binary [untested]</h1>

<ul>
<li>On the top left corner in Xcode select <code>SourcePoint_iOS_SDK</code> as the active scheme and select <code>Generic iOS Device</code> as the target device.</li>
<li>Clean and then build the project under Product menu.</li>
<li>Under the Products branch in Project Navigator on the left right click on <code>SourcePoint_iOS_SDK.framework</code> and select <code>Show in Finder</code>, it should point you to the location of a <code>SourcePoint_iOS_SDK.framework</code> file, that&rsquo;s you compiled framework you can import to other projects.</li>
</ul>
<h1 id='complete-docs' class='heading'>Complete Docs</h1>

<p>For the complete docs open the <code>./SourcePoint_iOS_SDK/docs/index.html</code> in the browser. </p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2018 <a class="link" href="" target="_blank" rel="external"></a>. All rights reserved. (Last updated: 2018-11-27)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.4</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
